---
title: 区块链记账原理
date: 2019-06-10 19:56:24
tags: 
    - 区块链
---
<meta name="referrer" content="no-referrer" />

## 前言

```yml
区块链(1.0)是一个基于密码学安全的分布式账本，是一个方便验证，不可篡改的账本。 通常认为与智能合约相结合的区块链为区块链2.0, 如以太坊是典型的区块链2.0
很多人只了解过比特币，不知道区块链，比特币实际是一个使用了区块链技术的应用，只是比特币当前太热，把区块链技术的光芒给掩盖了。区块链才是未来。
```

## 哈希函数

在讲区块链记账之前，先说明一下哈希函数。
```json
哈希函数：Hash(原始信息) = 摘要信息
```

原始信息可以是任意的信息， hash 之后会得到一个简短的摘要信息

哈希函数有几个特点：

- 同样的原始信息用同一个哈希函数总能得到相同的摘要信息
- 原始信息任何微小的变化都会哈希出面目全非的摘要信息
- 从摘要信息无法逆向推算出原始信息

举例说明：
Hash(张三借给李四 100 万，利息 1%，1 年后还本息 .....) = AC4635D34DEF
账本上记录了 AC4635D34DEF 这样一条记录。

可以看出哈希函数有 4 个作用：

- 简化信息
很好理解，哈希后的信息变短了。
- 标识信息
可以使用 AC4635D34DEF 来标识原始信息，摘要信息也称为原始信息的 id。
- 隐匿信息
账本是 AC4635D34DEF 这样一条记录，原始信息被隐匿。
- 验证信息
假如李四在还款时欺骗说，张三只借给李四 10 万，双方可以用 AC4635D34DEF 来验证原始信息

哈希函数的这 4 个作用在区块链技术里有广泛的运用。

## 区块链记账方法

假设有一个账页序号为 0 的账页交易记录如下：

账号	|入账	|出账|	余额	|备注说明
---|---|---|---|---
王二|	100	|	|190	|收到 xxx 货款
张三|	|	100|	30	|xxxx
李四|	120|	90|	170	|xxxx

区块链在记账是会把账页信息（包含序号、记账时间、交易记录）作为原始信息进行 Hash, 得到一个 Hash 值，如：787635ACD, 用函数表示为：

```json
Hash(序号0、记账时间、交易记录) = 787635ACD
```

账页信息和 Hash 值组合在一起就构成了第一个区块（创世区块）。

```json
比特币系统里约 10 分钟记一次账，即每个区块生成时间大概间隔 10 分钟
```

在记第 2 个账页的时候，会把上一个块的 Hash 值和当前的账页信息一起作为原始信息进行 Hash,即：

```json
Hash(上一个Hash值、序号1、记账时间、交易记录) = 456635BCD
```

这样第 2 个区块不仅包含了本账页信息，还间接的包含了第一个区块的信息。依次按照此方法继续记账，则最新的区块总是间接包含了所有之前的账页信息。

所有这些区块组合起来就形成了区块链，这样的区块链就构成了一个

- 便于验证（只要验证最后一个区块的 Hash 值就相当于验证了整个账本）
- 不可更改（任何一个交易信息的更改，会让所有之后的区块的 Hash 值发生变化，这样在验证时就无法通过）

的总账本